המשפט האחרון של פרמה הוא משפט מפורסם בתורת המספרים שנוסח על ידי המתמטיקאי פייר דה פרמה בשנת 1637 ונותר כבעיה פתוחה, עד שהוכח על ידי אנדרו ויילס (Wiles) בשנת 1995. במשך כ-350 שנים היה לאחת הטענות המפורסמות ביותר בעולם המתמטיקה שלא הוכחו.
המשפט טוען כי:

להבדיל, למשוואה 
  
    
      
        
        
        
          x
          
            2
          
        
        +
        
          y
          
            2
          
        
        =
        
          z
          
            2
          
        
      
    
    {\displaystyle \!\,x^{2}+y^{2}=z^{2}}
  , הנובעת ממשפט פיתגורס, יש אינסוף פתרונות שבהם y, x ו-z הם מספרים טבעיים, למשל 
  
    
      
        
        
        
          3
          
            2
          
        
        +
        
          4
          
            2
          
        
        =
        
          5
          
            2
          
        
      
    
    {\displaystyle \!\,3^{2}+4^{2}=5^{2}}
   ‏ או 
  
    
      
        
        
        
          5
          
            2
          
        
        +
        
          12
          
            2
          
        
        =
        
          13
          
            2
          
        
      
    
    {\displaystyle \!\,5^{2}+12^{2}=13^{2}}
  . פתרונות אלו ידועים כשלשות פיתגוריות. במשך כ-350 שנה הייתה שאלה זו בגדר בעיה פתוחה במתמטיקה, כנראה המפורסמת מכולן.


== תולדות המשפט ==

פייר דה פרמה (Fermat), מתמטיקאי צרפתי בן המאה ה-17, קבע, בערך בשנת 1637, שהתשובה לשאלה זו היא שלילית, אך לא נמצאה בכתביו הוכחה לכך. "גיליתי הוכחה נפלאה למשפט זה, אך שוליים אלו צרים מלהכילה", כתב פרמה בשולי ספרו של דיופנטוס, "אריתמטיקה", שתורגם ללטינית על ידי קלוד באשה. במשך מאות שנים דרבנה הערה זו מתמטיקאים וחובבי מתמטיקה לחפש הוכחה לטענתו של פרמה, שזכתה לכינוי המשפט האחרון של פרמה (המילה "אחרון" מציינת שזה המשפט האחרון שנותר להוכחה, לאחר שעד תחילת המאה התשע-עשרה הוכחו (או הופרכו) כל שאר המשפטים שניסח פרמה).
תחילת הדרך במסע לחיפוש ההוכחה כללה הוכחות למקרים פרטיים אחדים. בכתביו של פרמה נמצא גרעין של הוכחת נסיגה אינסופית למקרה הפרטי n=4, שפירושו שלמשוואה 
  
    
      
        
        
        
          x
          
            4
          
        
        +
        
          y
          
            4
          
        
        =
        
          z
          
            4
          
        
      
    
    {\displaystyle \!\,x^{4}+y^{4}=z^{4}}
   ‏ אין פתרון במספרים טבעיים. כמאה שנה לאחר מכן נתן לאונרד אוילר הוכחה למקרה הפרטי n=3. בשנת 1825 ניתנה הוכחה למקרה הפרטי n=5 על ידי לז'נדר, וכעבור ארבע-עשרה שנים נוספות הוכיח גבריאל לאמה (Lamé) את המשפט עבור n=7.
בשנת 1847 ניסה לאמה לתת הוכחה לנכונות המשפט האחרון של פרמה בשלמותו, אך הוכחתו נמצאה שגויה. עד לשנת 1857 הראה ארנסט קומר שהמשפט האחרון של פרמה נכון לכל n קטן ממאה. למעשה הוכיח קומר יותר מכך: הוא הוכיח שמשפט פרמה נכון לכל מספר ראשוני רגולרי, אך הבדיקה האם ראשוני הוא רגולרי הצריכה חישובים רבים. השתכללות אמצעי החישוב במאה העשרים איפשרה להגדיל בהדרגה את מספרן של החזקות לגביהן נמצא משפט פרמה כנכון, וכך הושגו אבני דרך אחדות: בשנת 1937 נמצא המשפט נכון לכל החזקות עד 617, בשנת 1955 הוגבה הרף ל-4,001, בשנת 1976 ל-125,000, ובשנת 1992 הוכחה נכונות המשפט לכל חזקה עד ארבעה מיליון.
בשנת 1823 הוכיחה סופי ז'רמן שאם יש פתרון למשוואה של פרמה, חייב אחד הנעלמים להיות כפולה של החזקה, כל עוד החזקה קטנה ממאה. עבודה זו הוצגה בפני האקדמיה הצרפתית למדעים על ידי לז'נדר, משום שהאקדמיה מנעה מנשים להופיע בפניה. בשנת 1982 הוכח שהתוצאה אליה הגיעה סופי ז'רמן נכונה גם כל עוד החזקה קטנה מ-6 מיליארד.
בשנת 1984 יצר המתמטיקאי הגרמני גרהארד פריי זיקה בין המשפט האחרון של פרמה לבין השערה בלתי מוכחת אחרת, השערת טניאמה-שימורה. על פי השערה זו, עבור כל עקום אליפטי המוגדר מעל הרציונליים, פונקציית L של העקום מתלכדת עם פונקציית L של תבנית מודולרית כלשהי. זיקה זו אומרת שמהוכחתה של השערת טניאמה-שימורה נובעת נכונותו של המשפט האחרון של פרמה.
אם 
  
    
      
         
        
          u
          
            p
          
        
        +
        
          v
          
            p
          
        
        =
        
          w
          
            p
          
        
      
    
    {\displaystyle \ u^{p}+v^{p}=w^{p}}
   היא דוגמה נגדית למשפט פרמה (כאשר p ראשוני ו- u,v,w מספרים שלמים), אז המשוואה 
  
    
      
         
        
          y
          
            2
          
        
        =
        x
        (
        x
        +
        
          u
          
            p
          
        
        )
        (
        x
        −
        
          v
          
            p
          
        
        )
      
    
    {\displaystyle \ y^{2}=x(x+u^{p})(x-v^{p})}
   מתארת עקום אליפטי המוגדר מעל הרציונליים. משוואה זו נלמדה עוד לפני שהקשר בין משפט פרמה, תבניות מודולריות ועקומים אליפטיים הובן במלואו, אך גרהארד פריי היה הראשון שהראה שעקום זה, אם הוא קיים, אינו מודולרי. ז'אן-פייר סר היה מי שהראה כיצד לקשר תבניות מודולריות למשפט פרמה, על ידי מה שכונה "השערת האפסילון", שהוכחה מאוחר יותר, ב-1986, על ידי קן ריבט. עבודתו של ריבט הרחיקה מעבר להשערת האפסילון, כשהוא הראה שממשפט טניאמה-שימורה, אפילו אם הוא נכון רק במקרה ה"יציב למחצה", נובע המשפט האחרון של פרמה. למעשה, הדבר נתן אפשרות להוכיח בדרך השלילה את המשפט האחרון של פרמה, שכן מניחים מראש שהמשוואה שפרמה טען שלא קיימת דווקא קיימת, מוכיחים כי היא אינה מודולרית (בצורה ספציפית למשוואה זו) וכן שהיא מודולרית (על פי השערת טניאמה שימורה) ולפיכך מגיעים לסתירה, והמסקנה היא שמשוואה זו לא קיימת.
עבודתו זו של ריבט גרמה לוויילס, מתמטיקאי בריטי מאוניברסיטת פרינסטון שבארצות-הברית, להפנות את עיקר מרצו להוכחת ההשערה של טניאמה ושימורה, מאחר שכעת היה ברור שהוכחה כזו תפתור גם את האתגר מן המאה ה-17, המשפט האחרון של פרמה.
בכנס שנערך בחודש יוני 1993 הציג ויילס הוכחה להשערת טניאמה-שימורה. במהלך ביקורת עמיתים התגלה פגם בהוכחה זו, אך פגם זה תוקן על ידי ויילס ותלמידו, ריצ'רד טיילור, וההוכחה פורסמה בגיליון חודש מאי 1995 של כתב העת Annals of Mathematics. מהוכחה זו נובעת נכונות המשפט האחרון של פרמה.
הוכחתו של ויילס טכנית ומסובכת מאוד, משתרעת על פני 129 עמודים, עושה שימוש בטכניקות מתמטיות שפותחו רק במאה ה-20 ובלתי ניתנת להבנה גם על ידי רוב המתמטיקאים. לא ייתכן שפרמה התייחס להוכחה זו בדברו על הוכחה "פשוטה להפליא", והדעה המקובלת היא שהוכחה כזו אינה קיימת. למרות זאת, גם בימינו ישנם כאלו המחפשים אחר ההוכחה ה"פשוטה" למשפט האחרון של פרמה.


== פרסים שהוצעו עבור הוכחת המשפט ==
ב-1816 ושוב ב-1850 הציעה האקדמיה הצרפתית למדעים פרס כספי למוכיח המשפט. ב-1857 העניקה האקדמיה 3,000 פרנק ומדליית זהב לארנסט קומר (Kummer) על עבודתו, אף שלא הגיש את עבודתו לפרס.
בצוואתו משנת 1908 של התעשיין היהודי-גרמני והמתמטיקאי פאול וולפסקהל (Wolfskehl) הוקצו 100,000 מרקים כדי לממן פרס למי שיצליח להוכיח את המשפט. הזכייה בפרס הפכה ליעדם של מתמטיקאים חובבים רבים, שטענו שמצאו הוכחה למשפט. בכל המקרים נמצאה הוכחתם שגויה. באוניברסיטת גטינגן, לשם נשלחו ההוכחות, הכין ראש המחלקה למתמטיקה אדמונד לנדאו מכתב סטנדרטי עם מספרי העמוד והשורה בהם נמצאה הטעות הראשונה. הפרס היה אמור להינתן להוכחה שתתפרסם בכתב עת מתמטי, ולאחר זמן המתנה של שנתיים. הפרס אמור היה לפקוע ב-2007, כמאה שנה לאחר הכרזתו. ב-1997 הוענק הפרס לאנדרו ויילס. שוויו היה באותה העת כ-$50,000.


== הכללות ==
את השאלה האם קיימים פתרונות למשוואה 
  
    
      
         
        
          x
          
            n
          
        
        +
        
          y
          
            n
          
        
        =
        
          z
          
            n
          
        
      
    
    {\displaystyle \ x^{n}+y^{n}=z^{n}}
   אפשר לשאול לא רק במספרים השלמים, אלא גם במערכות מתמטיות אחרות.
למשל, בחוג המספרים 
  
    
      
         
        
          Z
        
        [
        
          
            −
            7
          
        
        ]
      
    
    {\displaystyle \ \mathbb {Z} [{\sqrt {-7}}]}
   מתקיים השוויון 
  
    
      
         
        (
        1
        +
        
          
            −
            7
          
        
        
          )
          
            4
          
        
        +
        (
        1
        −
        
          
            −
            7
          
        
        
          )
          
            4
          
        
        =
        
          2
          
            4
          
        
      
    
    {\displaystyle \ (1+{\sqrt {-7}})^{4}+(1-{\sqrt {-7}})^{4}=2^{4}}
  , כך שהמשפט אינו נכון שם (עבור n=4); בין חוגי השלמים של ההרחבות הריבועיות של הרציונליים, 
  
    
      
         
        
          Q
        
        [
        
          
            −
            7
          
        
        ]
      
    
    {\displaystyle \ \mathbb {Q} [{\sqrt {-7}}]}
   הוא היחיד שבו יש פתרון עבור n=4. בין ההרחבות האלה, במקרים רבים יש פתרון עבור n=3, בעוד שעבור n=6 או n=9 אין אף לא הרחבה אחת שבה יש למשוואה פתרון. ידוע גם שאין למשוואה פתרונות בחוגי פולינומים מעל שדה (אם המאפיין של השדה אינו מחלק את n).
אוילר שיער שלא ניתן לפתור את המשוואה 
  
    
      
         
        
          x
          
            1
          
          
            n
          
        
        +
        ⋯
        +
        
          x
          
            n
            −
            1
          
          
            n
          
        
        =
        
          z
          
            n
          
        
      
    
    {\displaystyle \ x_{1}^{n}+\dots +x_{n-1}^{n}=z^{n}}
   במספרים שלמים, כאשר 
  
    
      
         
        2
        <
        n
      
    
    {\displaystyle \ 2<n}
  . השערה זו אינה נכונה, כפי שמראה השוויון 
  
    
      
         
        
          27
          
            5
          
        
        +
        
          84
          
            5
          
        
        +
        
          110
          
            5
          
        
        +
        
          133
          
            5
          
        
        =
        
          144
          
            5
          
        
      
    
    {\displaystyle \ 27^{5}+84^{5}+110^{5}+133^{5}=144^{5}}
  .
עבור פולינומים, ידועה הגרסה הבאה: מעל שדה F ממאפיין 0, אם n>2, אז כל פתרון 
  
    
      
         
        x
        (
        t
        
          )
          
            n
          
        
        +
        y
        (
        t
        
          )
          
            n
          
        
        =
        z
        (
        t
        
          )
          
            n
          
        
      
    
    {\displaystyle \ x(t)^{n}+y(t)^{n}=z(t)^{n}}
   שבו 
  
    
      
        x
        ,
        y
        ,
        z
      
    
    {\displaystyle x,y,z}
   פולינומים זרים, הוא למעשה פתרון בקבועים.


== בתרבות ==

כמשפט מתמטי מפורסם למדי זכה המשפט האחרון של פרמה לאזכורים בסדרות טלוויזיה שונות, ובהן "משפחת סימפסון", שבה הציג הומר דוגמה נגדית (שגויה) למשפט, "דוקטור הו", שבה הדוקטור ה-11 משחזר את ההוכחה המקורית של פרמה, וב"מסע בין כוכבים: הדור הבא", בפרק משנת 1989, שבו מתאר הקפטן ז'אן-לוק פיקארד את המשפט כ"חידה שאולי לעולם לא נפתור". המשפט מוזכר גם בסיפור הקצר "השטן וסיימון פלאג" מאת ארתור פורג'יס (Arthur Porges) שבו מנסה סיימון להכשיל את השטן בדרישה שיוכיח את המשפט האחרון של פרמה, בסרט "הרי את מכושפת לי", במחזה "ארקדיה" מאת טום סטופארד, ברומן "רציחות נוסח אוקספורד", שבו מתמטיקאים נוסעים באוטובוס מאוניברסיטת אוקספורד לאוניברסיטת קיימברידג' כדי לשמוע את הרצאתו של אנדרו ויילס, ועוד.


== ראו גם ==
עקום פרמה
השערת ביל


== לקריאה נוספת ==
סיימון סינג, המשפט האחרון של פרמה, הוצאת ידיעות אחרונות, 2000. (הספר בקטלוג ULI)
חיים שפירא, אינסוף - המסע שאינו נגמר, כנרת זמורה ביתן, 2010 (עמודים 168–186) (הספר בקטלוג ULI)


== קישורים חיצוניים ==

דוד שי, המשפט האחרון של פרמה
מיכאל רוזנברג, המשפט האחרון של פרמה - ההוכחה המיוחלת
ליאו קורי, "המשפט האחרון של פרמה". איך הופכת שאלה שבשוליים לבעיה מתמטית חשובה ולרב-מכר עטור תהילה
המשפט האחרון של פרמה, באתר MathWorld (באנגלית)
״משפט בשוליים״ - פרק על חייו של פייר דה פרמה והמשפט האחרון בפודקאסט ״מינהר הזמן״, ״כאן״, תאגיד השידור הישראלי
המשפט האחרון של פרמה, באתר אנציקלופדיה בריטניקה (באנגלית)


== הערות שוליים ==