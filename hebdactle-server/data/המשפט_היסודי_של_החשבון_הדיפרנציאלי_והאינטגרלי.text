המשפט היסודי של החשבון הדיפרנציאלי והאינטגרלי (נקרא גם המשפט היסודי של החשבון האינפיניטסימלי או משפט ניוטון-לייבניץ על שם מפתחי החשבון האינפיניטסימלי) קושר בין שני מושגי היסוד של החשבון האינפיניטסימלי, הנגזרת והאינטגרל, ומראה שגזירה ואינטגרציה הן פעולות הופכיות זו לזו: אם פונקציה רציפה עוברת אינטגרציה ואחר כך גוזרים את התוצאה, חוזרים לפונקציה המקורית. פרט לקשר זה, המשפט גם מספק שיטה מעשית לחישוב האינטגרל המסוים, שהוא מושג שמוגדר בצורה שאינה מאפשרת חישוב פשוט, באמצעות האינטגרל הלא מסוים, שלחישובו יש דרכים רבות (ולרוב פשוטות) יותר.
המשפט היסודי של החשבון האינפיניטסימלי קובע, שעבור פונקציות אינטגרביליות שיש להן פונקציה קדומה, האינטגרל המסוים בין שתי נקודות שווה להפרש הערכים של האינטגרל הלא המסוים שלה בנקודות אלו.
לכאורה שני מושגים אלה שונים זה מזה ובאים מעולמות שונים, אבל המשפט היסודי של החשבון הדיפרנציאלי והאינטגרלי קובע את הקשר העמוק בין שני התחומים.


== ניסוח פורמלי ==

המשפט היסודי של החשבון האינטגרלי מורכב בעצם משני משפטים:


=== משפט ===
תהי 
  
    
      
        f
      
    
    {\displaystyle f}
   פונקציה אינטגרבילית בקטע 
  
    
      
        [
        a
        ,
        b
        ]
      
    
    {\displaystyle [a,b]}
   ויהי 
  
    
      
         
        F
        (
        x
        )
        =
        
          ∫
          
            a
          
          
            x
          
        
        f
        (
        t
        )
        
        
          d
        
        t
      
    
    {\displaystyle \ F(x)=\int _{a}^{x}f(t)\,\mathrm {d} t}
   (כאשר 
  
    
      
        x
        ∈
        [
        a
        ,
        b
        ]
      
    
    {\displaystyle x\in [a,b]}
  ) אינטגרל מסוים שלה (המכונה לעיתים גם "הפונקציה צוברת השטח של 
  
    
      
        f
      
    
    {\displaystyle f}
  "). אזי:

הפונקציה 
  
    
      
        F
      
    
    {\displaystyle F}
   רציפה.
בכל נקודה 
  
    
      
        
          x
          
            0
          
        
      
    
    {\displaystyle x_{0}}
   בה 
  
    
      
        f
      
    
    {\displaystyle f}
   רציפה, 
  
    
      
         
        F
      
    
    {\displaystyle \ F}
   גזירה ומתקיים: 
  
    
      
        
          F
          ′
        
        (
        
          x
          
            0
          
        
        )
        =
        f
        (
        
          x
          
            0
          
        
        )
      
    
    {\displaystyle F'(x_{0})=f(x_{0})}
   .
אם 
  
    
      
        f
      
    
    {\displaystyle f}
   רציפה בכל הקטע, אזי קיימת לה פונקציה קדומה בקטע, והפונקציה 
  
    
      
        F
        (
        x
        )
        =
        
          ∫
          
            a
          
          
            x
          
        
        f
        (
        t
        )
        
        
          d
        
        t
      
    
    {\displaystyle F(x)=\int _{a}^{x}f(t)\,\mathrm {d} t}
   היא פונקציה קדומה שמקיימת 
  
    
      
        
          F
          ′
        
        =
        f
      
    
    {\displaystyle F'=f}
   בכל הקטע.יתרה מזאת, כל פונקציה מהסוג 
  
    
      
        F
        (
        x
        )
        =
        
          ∫
          
            a
          
          
            x
          
        
        f
        (
        t
        )
        
        
          d
        
        t
        +
        C
      
    
    {\displaystyle F(x)=\int _{a}^{x}f(t)\,\mathrm {d} t+C}
  , כאשר 
  
    
      
        C
      
    
    {\displaystyle C}
   הוא קבוע, גם היא פונקציה קדומה של 
  
    
      
        f
      
    
    {\displaystyle f}
  , וכל הפונקציות הקדומות של 
  
    
      
        f
      
    
    {\displaystyle f}
   הן מהסוג הזה.


=== משפט (נוסחת ניוטון-לייבניץ) ===
תהי 
  
    
      
         
        f
      
    
    {\displaystyle \ f}
   פונקציה אינטגרבילית שיש לה פונקציה קדומה 
  
    
      
         
        F
      
    
    {\displaystyle \ F}
   בקטע 
  
    
      
         
        [
        a
        ,
        b
        ]
      
    
    {\displaystyle \ [a,b]}
  . אם נסמן 
  
    
      
        
          
            d
            
              
                d
              
              x
            
          
        
        F
        (
        x
        )
        =
        f
        (
        x
        )
      
    
    {\displaystyle {\frac {d}{\mathrm {d} x}}F(x)=f(x)}
   אזי

  
    
      
         
        
          ∫
          
            a
          
          
            b
          
        
        f
        (
        x
        )
        
        
          d
        
        x
        =
        F
        (
        x
        )
        
          ∣
          
            a
          
          
            b
          
        
        =
        F
        (
        b
        )
        −
        F
        (
        a
        )
      
    
    {\displaystyle \ \int _{a}^{b}f(x)\,\mathrm {d} x=F(x)\mid _{a}^{b}=F(b)-F(a)}
  נשים לב שאין חשיבות לשאלה איזו פונקציה קדומה של 
  
    
      
         
        f
      
    
    {\displaystyle \ f}
   לוקחים, מכיוון שכל הפונקציות הקדומות של 
  
    
      
         
        f
      
    
    {\displaystyle \ f}
   נבדלות זו מזו בקבוע, והוא מתבטל כאשר מחשבים את ההפרש בין ערכי הפונקציה הקדומה בשתי נקודות שונות.
הנוסחה היסודית של החשבון האינפיניטסימלי מאפשרת לחשב אינטגרלים מסוימים של פונקציות מסוג מסוים.
בתורת המידה מוכללת נוסחה זו למשפחה רחבה יותר של פונקציות, הפונקציות הרציפות בהחלט. ניתן להראות גם שזו משפחת הפונקציות הרחבה ביותר עבורה מתקיימת נוסחה זו. ישנן פונקציות רציפות וגזירות כמעט בכל מקום (אבל לא בכל מקום) שאינן האינטגרל של נגזרתן (ראו פונקציה סינגולרית).


== הוכחה ==


=== הפונקציה ===
  
    
      
        F
      
    
    {\displaystyle F}
   רציפה
נתון ש־
  
    
      
        f
      
    
    {\textstyle f}
   אינטגרבילית לפי רימן ולכן היא חסומה, כלומר קיים 
  
    
      
        M
        ∈
        
          R
        
      
    
    {\textstyle M\in \mathbb {R} }
   כך ש־
  
    
      
        
          |
          
            f
            (
            x
            )
          
          |
        
        ≤
        M
      
    
    {\textstyle \left|f(x)\right|\leq M}
   לכל 
  
    
      
        x
        ∈
        
          [
          
            a
            ,
            b
          
          ]
        
      
    
    {\textstyle x\in \left[a,b\right]}
  . יהיו 
  
    
      
        x
        ,
        y
        ∈
        
          [
          
            a
            ,
            b
          
          ]
        
      
    
    {\textstyle x,y\in \left[a,b\right]}
  , אזי מתקיים:

כלומר 
  
    
      
        F
      
    
    {\textstyle F}
   מקיימת את תנאי ליפשיץ ב־
  
    
      
        
          [
          
            a
            ,
            b
          
          ]
        
      
    
    {\textstyle \left[a,b\right]}
  , ולכן היא רציפה במידה שווה (וּבִֿפֿרט רציפה).


=== הפונקציה ===
  
    
      
        f
      
    
    {\displaystyle f}
   היא נגזרת של 
  
    
      
        F
      
    
    {\displaystyle F}
   בנקודות הרציפות שלה
תהא 
  
    
      
         
        
          x
          
            0
          
        
      
    
    {\displaystyle \ x_{0}}
   נקודת רציפות של 
  
    
      
         
        f
      
    
    {\displaystyle \ f}
  . אנו רוצים להראות כי 
  
    
      
         
        
          F
          ′
        
        (
        
          x
          
            0
          
        
        )
        =
        f
        (
        
          x
          
            0
          
        
        )
      
    
    {\displaystyle \ F'(x_{0})=f(x_{0})}
   כאשר 
  
    
      
         
        F
        =
        
          ∫
          
            a
          
          
            x
          
        
        f
        (
        t
        )
        
        
          d
        
        t
      
    
    {\displaystyle \ F=\int _{a}^{x}f(t)\,\mathrm {d} t}
  .
בסימון פורמלי יותר: אנו רוצים להראות כי 
  
    
      
         
        
          lim
          
            h
            →
            0
          
        
        
          
            
              F
              (
              
                x
                
                  0
                
              
              +
              h
              )
              −
              F
              (
              
                x
                
                  0
                
              
              )
            
            h
          
        
        =
        f
        (
        
          x
          
            0
          
        
        )
      
    
    {\displaystyle \ \lim _{h\rightarrow 0}{\frac {F(x_{0}+h)-F(x_{0})}{h}}=f(x_{0})}
  .
על פי ההגדרה ואדיטיביות האינטגרל המסוים, אנו יודעים שמתקיים: 
  
    
      
         
        
          
            
              F
              (
              
                x
                
                  0
                
              
              +
              h
              )
              −
              F
              (
              
                x
                
                  0
                
              
              )
            
            h
          
        
        =
        
          
            1
            h
          
        
        
          (
          
            
              ∫
              
                a
              
              
                
                  x
                  
                    0
                  
                
                +
                h
              
            
            f
            (
            t
            )
            
            
              d
            
            t
            −
            
              ∫
              
                a
              
              
                
                  x
                  
                    0
                  
                
              
            
            f
            (
            t
            )
            
            
              d
            
            t
          
          )
        
        =
        
          
            1
            h
          
        
        
          ∫
          
            
              x
              
                0
              
            
          
          
            
              x
              
                0
              
            
            +
            h
          
        
        f
        (
        t
        )
        
        
          d
        
        t
      
    
    {\displaystyle \ {\frac {F(x_{0}+h)-F(x_{0})}{h}}={\frac {1}{h}}\left(\int _{a}^{x_{0}+h}f(t)\,\mathrm {d} t-\int _{a}^{x_{0}}f(t)\,\mathrm {d} t\right)={\frac {1}{h}}\int _{x_{0}}^{x_{0}+h}f(t)\,\mathrm {d} t}
  .
כמו כן מתקיים 
  
    
      
         
        f
        (
        
          x
          
            0
          
        
        )
        =
        
          
            1
            h
          
        
        
          ∫
          
            
              x
              
                0
              
            
          
          
            
              x
              
                0
              
            
            +
            h
          
        
        f
        (
        
          x
          
            0
          
        
        )
        
        
          d
        
        t
      
    
    {\displaystyle \ f(x_{0})={\frac {1}{h}}\int _{x_{0}}^{x_{0}+h}f(x_{0})\,\mathrm {d} t}
  , שכן 
  
    
      
         
        f
        (
        
          x
          
            0
          
        
        )
      
    
    {\displaystyle \ f(x_{0})}
   היא קבוע, ולכן האינטגרל שלה על הקטע 
  
    
      
         
        [
        
          x
          
            0
          
        
        ,
        
          x
          
            0
          
        
        +
        h
        ]
      
    
    {\displaystyle \ [x_{0},x_{0}+h]}
   הוא פשוט אורך הקטע כפול 
  
    
      
         
        f
        (
        
          x
          
            0
          
        
        )
      
    
    {\displaystyle \ f(x_{0})}
  .
לכן מתקיים, על פי אי שוויון המשולש האינטגרלי: 
  
    
      
         
        
          |
          
            
              
                
                  F
                  (
                  
                    x
                    
                      0
                    
                  
                  +
                  h
                  )
                  −
                  F
                  (
                  
                    x
                    
                      0
                    
                  
                  )
                
                h
              
            
            −
            f
            (
            
              x
              
                0
              
            
            )
          
          |
        
        =
        
          |
          
            
              
                1
                h
              
            
            
              ∫
              
                
                  x
                  
                    0
                  
                
              
              
                
                  x
                  
                    0
                  
                
                +
                h
              
            
            
              (
              
                f
                (
                t
                )
                −
                f
                (
                
                  x
                  
                    0
                  
                
                )
              
              )
            
            
            
              d
            
            t
          
          |
        
        ≤
        
          
            1
            
              
                |
              
              h
              
                |
              
            
          
        
        
          |
          
            
              ∫
              
                
                  x
                  
                    0
                  
                
              
              
                
                  x
                  
                    0
                  
                
                +
                h
              
            
            
              |
              
                f
                (
                t
                )
                −
                f
                (
                
                  x
                  
                    0
                  
                
                )
              
              |
            
            
            
              d
            
            t
          
          |
        
      
    
    {\displaystyle \ \left|{\frac {F(x_{0}+h)-F(x_{0})}{h}}-f(x_{0})\right|=\left|{\frac {1}{h}}\int _{x_{0}}^{x_{0}+h}\left(f(t)-f(x_{0})\right)\,\mathrm {d} t\right|\leq {\frac {1}{|h|}}\left|\int _{x_{0}}^{x_{0}+h}\left|f(t)-f(x_{0})\right|\,\mathrm {d} t\right|}
  .
נזכור כי 
  
    
      
         
        f
        (
        x
        )
      
    
    {\displaystyle \ f(x)}
   רציפה בנקודה 
  
    
      
         
        
          x
          
            0
          
        
      
    
    {\displaystyle \ x_{0}}
  , ולכן עבור 
  
    
      
         
        ε
        >
        0
      
    
    {\displaystyle \ \varepsilon >0}
   כלשהו קיים 
  
    
      
         
        δ
        >
        0
      
    
    {\displaystyle \ \delta >0}
   כך ש-
  
    
      
         
        
          |
        
        t
        −
        
          x
          
            0
          
        
        
          |
        
        <
        δ
      
    
    {\displaystyle \ |t-x_{0}|<\delta }
   גורר 
  
    
      
         
        
          |
        
        f
        (
        t
        )
        −
        f
        (
        
          x
          
            0
          
        
        )
        
          |
        
        <
        ε
      
    
    {\displaystyle \ |f(t)-f(x_{0})|<\varepsilon }
  .
אם 
  
    
      
         
        0
        <
        
          |
        
        h
        
          |
        
        <
        δ
      
    
    {\displaystyle \ 0<|h|<\delta }
   אז לכל 
  
    
      
         
        t
        ∈
        [
        
          x
          
            0
          
        
        ,
        
          x
          
            0
          
        
        +
        h
        ]
      
    
    {\displaystyle \ t\in [x_{0},x_{0}+h]}
   מתקיים 
  
    
      
         
        
          |
        
        t
        −
        
          x
          
            0
          
        
        
          |
        
        <
        δ
      
    
    {\displaystyle \ |t-x_{0}|<\delta }
  . לכן:

  
    
      
         
        
          
            1
            
              
                |
              
              h
              
                |
              
            
          
        
        
          |
          
            
              ∫
              
                
                  x
                  
                    0
                  
                
              
              
                
                  x
                  
                    0
                  
                
                +
                h
              
            
            
              |
              
                f
                (
                t
                )
                −
                f
                (
                
                  x
                  
                    0
                  
                
                )
              
              |
            
            
            
              d
            
            t
          
          |
        
        ≤
        
          
            1
            
              
                |
              
              h
              
                |
              
            
          
        
        
          |
          
            
              ∫
              
                
                  x
                  
                    0
                  
                
              
              
                
                  x
                  
                    0
                  
                
                +
                h
              
            
            ε
            
            
              d
            
            t
          
          |
        
        =
        
          
            1
            
              
                |
              
              h
              
                |
              
            
          
        
        ε
        ⋅
        
          |
        
        h
        
          |
        
        =
        ε
      
    
    {\displaystyle \ {\frac {1}{|h|}}\left|\int _{x_{0}}^{x_{0}+h}\left|f(t)-f(x_{0})\right|\,\mathrm {d} t\right|\leq {\frac {1}{|h|}}\left|\int _{x_{0}}^{x_{0}+h}\varepsilon \,\mathrm {d} t\right|={\frac {1}{|h|}}\varepsilon \cdot |h|=\varepsilon }
  .
כלומר, הראינו כי לכל 
  
    
      
         
        ε
        >
        0
      
    
    {\displaystyle \ \varepsilon >0}
   ניתן למצוא 
  
    
      
         
        δ
        >
        0
      
    
    {\displaystyle \ \delta >0}
   כך שלכל 
  
    
      
         
        
          |
        
        h
        
          |
        
        <
        δ
      
    
    {\displaystyle \ |h|<\delta }
   יתקיים 
  
    
      
         
        
          |
          
            
              
                
                  F
                  (
                  
                    x
                    
                      0
                    
                  
                  +
                  h
                  )
                  −
                  F
                  (
                  
                    x
                    
                      0
                    
                  
                  )
                
                h
              
            
            −
            f
            (
            
              x
              
                0
              
            
            )
          
          |
        
        <
        ε
      
    
    {\displaystyle \ \left|{\frac {F(x_{0}+h)-F(x_{0})}{h}}-f(x_{0})\right|<\varepsilon }
  , כלומר 
  
    
      
         
        
          lim
          
            h
            →
            0
          
        
        
          
            
              F
              (
              
                x
                
                  0
                
              
              +
              h
              )
              −
              F
              (
              
                x
                
                  0
                
              
              )
            
            h
          
        
        =
        f
        (
        
          x
          
            0
          
        
        )
      
    
    {\displaystyle \ \lim _{h\rightarrow 0}{\frac {F(x_{0}+h)-F(x_{0})}{h}}=f(x_{0})}
  , כמבוקש.
מ.ש.ל.


=== קיום פונקציה קדומה בקטע ונוסחת ניוטון-לייבניץ ===
הוכחת המשפט במקרה פרטי של פונקציה רציפה.
אם 
  
    
      
         
        f
      
    
    {\displaystyle \ f}
   רציפה בכל הקטע 
  
    
      
         
        [
        a
        ,
        b
        ]
      
    
    {\displaystyle \ [a,b]}
   אז היא בפרט אינטגרבילית בו (רציפות גוררת אינטגרביליות) ואז כפי שראינו קודם, הפונקציה 
  
    
      
         
        F
        (
        x
        )
        =
        
          ∫
          
            a
          
          
            x
          
        
        f
        (
        t
        )
        
        
          d
        
        t
      
    
    {\displaystyle \ F(x)=\int _{a}^{x}f(t)\,\mathrm {d} t}
   מקיימת לכל נקודה שבה 
  
    
      
         
        f
      
    
    {\displaystyle \ f}
   רציפה (במקרה זה, כל הקטע) 
  
    
      
         
        
          F
          ′
        
        (
        x
        )
        =
        f
        (
        x
        )
      
    
    {\displaystyle \ F'(x)=f(x)}
  . לכן 
  
    
      
         
        F
        (
        x
        )
      
    
    {\displaystyle \ F(x)}
   היא פונקציה קדומה של 
  
    
      
         
        f
        (
        x
        )
      
    
    {\displaystyle \ f(x)}
   בקטע.
על פי הגדרה: 
  
    
      
         
        F
        (
        b
        )
        −
        F
        (
        a
        )
        =
        
          ∫
          
            a
          
          
            b
          
        
        f
        (
        t
        )
        
        
          d
        
        t
        −
        
          ∫
          
            a
          
          
            a
          
        
        f
        (
        t
        )
        
        
          d
        
        t
        =
        
          ∫
          
            a
          
          
            b
          
        
        f
        (
        t
        )
        
        
          d
        
        t
      
    
    {\displaystyle \ F(b)-F(a)=\int _{a}^{b}f(t)\,\mathrm {d} t-\int _{a}^{a}f(t)\,\mathrm {d} t=\int _{a}^{b}f(t)\,\mathrm {d} t}
  .
כעת, כל שתי פונקציות קדומות של 
  
    
      
         
        f
        (
        x
        )
      
    
    {\displaystyle \ f(x)}
   נבדלות ביניהן בקבוע. כי נניח ש-
  
    
      
         
        F
        (
        x
        )
        ,
        G
        (
        x
        )
      
    
    {\displaystyle \ F(x),G(x)}
   שתיהן פונקציות קדומות של 
  
    
      
         
        f
        (
        x
        )
      
    
    {\displaystyle \ f(x)}
  , אז 
  
    
      
         
        
          
            (
            
              F
              (
              x
              )
              −
              G
              (
              x
              )
            
            )
          
          ′
        
        =
        f
        (
        x
        )
        −
        f
        (
        x
        )
        =
        0
      
    
    {\displaystyle \ \left(F(x)-G(x)\right)'=f(x)-f(x)=0}
  , כלומר הפונקציה 
  
    
      
         
        F
        (
        x
        )
        −
        G
        (
        x
        )
      
    
    {\displaystyle \ F(x)-G(x)}
   היא קבוע, כלומר 
  
    
      
         
        F
        (
        x
        )
        =
        G
        (
        x
        )
        +
        c
      
    
    {\displaystyle \ F(x)=G(x)+c}
  .
על כן: 
  
    
      
         
        G
        (
        b
        )
        −
        G
        (
        a
        )
        =
        F
        (
        b
        )
        −
        c
        −
        
          (
          
            F
            (
            a
            )
            −
            c
          
          )
        
        =
        F
        (
        b
        )
        −
        F
        (
        a
        )
      
    
    {\displaystyle \ G(b)-G(a)=F(b)-c-\left(F(a)-c\right)=F(b)-F(a)}
  , וזאת לכל פונקציה קדומה 
  
    
      
         
        G
        (
        x
        )
      
    
    {\displaystyle \ G(x)}
   של 
  
    
      
         
        f
        (
        x
        )
      
    
    {\displaystyle \ f(x)}
  . 
בזאת הושלמה הוכחת הנוסחה היסודית עבור פונקציה רציפה.
מ.ש.ל.
הערות:

כדי להוכיח את המשפט עבור המקרה הכללי שf אינטרבילית וF היא פונקציה קדומה של f בכל הקטע 
  
    
      
         
        [
        a
        ,
        b
        ]
      
    
    {\displaystyle \ [a,b]}
  יש להשתמש בסכומי רימן ומשפט הערך הממוצע של לגראנז'.
המשפט אף נכון למקרה מוכלל בו f אינטגרבילית ופרט למספר סופי של נקודות F היא פונקציה קדומה של f ורציפה. ההוכחה דומה להערה 1.


=== הוכחה לנוסחת ניוטון-לייבניץ שאינה מתבססת על המשפט היסודי ===
תהי 
  
    
      
        P
        =
        (
        a
        =
        
          t
          
            0
          
        
        <
        ⋯
        <
        
          t
          
            n
          
        
        =
        b
        )
      
    
    {\displaystyle P=(a=t_{0}<\cdots <t_{n}=b)}
   חלוקה  כלשהי של 
  
    
      
         
        [
        a
        ,
        b
        ]
      
    
    {\displaystyle \ [a,b]}
  . אז לפי משפט הערך הממוצע של לגראנז' מתקיים:

עבור 
  
    
      
         
        i
        =
        1
        ,
        .
        .
        .
        ,
        n
      
    
    {\displaystyle \ i=1,...,n}
  ; כעת נגדיר 

ונקבל

כלומר

נסכום את המשוואה האחרונה עבור 
  
    
      
         
        i
        =
        1
        ,
        .
        .
        .
        ,
        n
      
    
    {\displaystyle \ i=1,...,n}
   ונקבל:

נשים לב ש- (שהרי זהו סכום טלסקופי) ונקבל:

עבור כל חלוקה 
  
    
      
         
        P
      
    
    {\displaystyle \ P}
  . אם כך מהגדרת האינטגרל התוצאה נובעת ישירות


== הכללות ==
הכללה טבעית של המשפט היסודי של החדו"א לשני ממדים היא משפט גרין. בממדים גבוהים יותר קיימות הכללות מורכבות יותר, כגון משפט גאוס, משפט סטוקס ומשפט הדיפרנציאציה של לבג.


== קישורים חיצוניים ==

המשפט היסודי של החשבון הדיפרנציאלי והאינטגרלי, באתר MathWorld (באנגלית)
המשפט היסודי של החשבון הדיפרנציאלי והאינטגרלי, באתר אנציקלופדיה בריטניקה (באנגלית)גדי אלכסנדרוביץ', המשפט היסודי של החשבון הדיפרנציאלי והאינטגרלי, באתר "לא מדויק", 2 בינואר 2011